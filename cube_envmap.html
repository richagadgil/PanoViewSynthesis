<!DOCTYPE html>
<html lang="en">
    <head>
        <title>three.js webgl - materials - environment maps</title>
    </head>
    <body>
        <script src="js/three.js"></script>
        <script>
            let controls, camera, scene, renderer;
            let textureEquirec, textureCube;
            let sphereMesh, sphereMaterial;

            init();
            animate();

            function init() {
                // CAMERAS

                camera = new THREE.PerspectiveCamera(
                    70,
                    window.innerWidth / window.innerHeight,
                    1,
                    100000
                );
                camera.position.set(0, 0, 1000);

                // SCENE

                scene = new THREE.Scene();

                // Lights

                const ambient = new THREE.AmbientLight(0xffffff);
                scene.add(ambient);

                // Textures

                const loader = new THREE.CubeTextureLoader();

                textureCube = loader.load([
                    'http://0.0.0.0:8000/deconstructed/image1.png',
                    'http://0.0.0.0:8000/deconstructed/image3.png',
                    'http://0.0.0.0:8000/deconstructed/image6.png',
                    'http://0.0.0.0:8000/deconstructed/image6.png',
                    'http://0.0.0.0:8000/deconstructed/image4.png',
                    'http://0.0.0.0:8000/deconstructed/image2.png'
                ]);
                textureCube.encoding = THREE.sRGBEncoding;

                scene.background = textureCube;

                //

                /*const geometry = new THREE.IcosahedronBufferGeometry(400, 15);
                sphereMaterial = new THREE.MeshLambertMaterial({
                    envMap: textureCube
                });
                sphereMesh = new THREE.Mesh(geometry, sphereMaterial);
                scene.add(sphereMesh);*/

                //

                renderer = new THREE.WebGLRenderer();
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.outputEncoding = THREE.sRGBEncoding;
                document.body.appendChild(renderer.domElement);

                //

                const params = {
                    Cube: function() {
                        scene.background = textureCube;

                        sphereMaterial.envMap = textureCube;
                        sphereMaterial.needsUpdate = true;
                    }
                };

                window.addEventListener('resize', onWindowResize, false);
            }

            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();

                renderer.setSize(window.innerWidth, window.innerHeight);
            }

            //

            var i = 0;

            function animate() {
                requestAnimationFrame(animate);
                camera.position.x = 0.05 * Math.sin(i / (10 * Math.PI));
                camera.rotation.y = i / (50 * Math.PI);
                i += 1;
                render();
            }

            function render() {
                //camera.lookAt(scene.position);
                renderer.render(scene, camera);
            }
        </script>
    </body>
</html>
